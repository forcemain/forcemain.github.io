<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>第 2 章 MongoDB基础知识 | Forcemain</title>
  <meta name="author" content="forcemain">
  
  <meta name="description" content="MongoDB非常强大但很容易上手。本章会介绍一些MongoDB的基本概念。

 * 文档（document）是MongoDB中数据的基本单元，非常类似于关系型数据库管理系统中的行，但更具有表现力。
 * 集合（collection）可以看作是一个拥有动态模式（dynamic schema）的表。
 * MongoDB的一个实例可以拥有多个相互独立的数据库（database），每一个数据库都拥有自己的集合。
 * 每一个文档都有一个特殊的键 “_id”，这个键在文档所属的集合中是唯一的。
 * MongoDB自带了一个简单但功能强大的JavaScript shell，可用于管理MongoDB的实例或数据操作。

2.1 文档
文档是MongoDB的核心概念。文档就是键值对的一个有序集。每种编"> 
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="第 2 章 MongoDB基础知识"/>
  <meta property="og:site_name" content="Forcemain"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="Forcemain" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
<meta name="generator" content="Hexo 6.3.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Forcemain</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class="fa fa-user"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> 第 2 章 MongoDB基础知识</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>MongoDB非常强大但很容易上手。本章会介绍一些MongoDB的基本概念。</p>
<ul>
<li>文档（document）是MongoDB中数据的基本单元，非常类似于关系型数据库管理系统中的行，但更具有表现力。</li>
<li>集合（collection）可以看作是一个拥有动态模式（dynamic schema）的表。</li>
<li>MongoDB的一个实例可以拥有多个相互独立的数据库（database），每一个数据库都拥有自己的集合。</li>
<li>每一个文档都有一个特殊的键 “_id”，这个键在文档所属的集合中是唯一的。</li>
<li>MongoDB自带了一个简单但功能强大的JavaScript shell，可用于管理MongoDB的实例或数据操作。</li>
</ul>
<h1 id="2-1-文档"><a href="#2-1-文档" class="headerlink" title="2.1 文档"></a>2.1 文档</h1><p>文档是MongoDB的核心概念。文档就是键值对的一个有序集。每种编程语言表示文档的方法不太一样，但大多数编程语言都有一些相通的数据结构，比如映射（map），散列（hash），字典（dictionary）。例如。在JavaScript里面，文档被表示为对象：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span><span class="token string-property property">"title"</span><span class="token operator">:</span> <span class="token string">"Forcemain"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这个文档只有一个键 “title”，其对应的值为 “Forcemain”。大多数文档会比这个简单的例子复杂很多。通常会包含多个键&#x2F;值对：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span><span class="token string-property property">"title"</span><span class="token operator">:</span> <span class="token string">"Forcemain"</span><span class="token punctuation">,</span> <span class="token string-property property">"titlecase"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>从上面的例子可以看出，文档中的值可以是多种不同的数据类型（甚至可以是一个完整的内嵌文档）。在这个例子中 “title” 的值是一个字符串，而 “titlecase” 的值是一个布尔值。</p>
<p>文档的键是字符串，除了少数例外情况，键可以使用任意UTF8字符。</p>
<ul>
<li>键不能含有 <code>\0</code>（空字符）。这个字符用于表示键的结尾。</li>
<li><code>.</code> 和 <code>$</code> 具有特殊意义，只能在特定环境下使用。通常，这两个字符是被保留的。如果使用不当的话，驱动程序会有提示。</li>
</ul>
<p>MongoDB不但区分类型，而且区分大小写。例如，下面两个文档是不同的：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span><span class="token string-property property">"titlecase"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">&#125;</span>

<span class="token punctuation">&#123;</span><span class="token string-property property">"titlecase"</span><span class="token operator">:</span> <span class="token string">"false"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>下面两个文档也是不同的：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span><span class="token string-property property">"title"</span><span class="token operator">:</span> <span class="token string">"Forcemain"</span><span class="token punctuation">&#125;</span>

<span class="token punctuation">&#123;</span><span class="token string-property property">"Title"</span><span class="token operator">:</span> <span class="token string">"Forcemain"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>还有一个非常重要的事项需要注意，MongoDB的文档不能有重复的键。例如下面的文档是非法的：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span><span class="token string-property property">"title"</span><span class="token operator">:</span> <span class="token string">"forcemain"</span><span class="token punctuation">,</span> <span class="token string-property property">"title"</span><span class="token operator">:</span> <span class="token string">"Forcemain"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>文档中的键&#x2F;值对是有序的：<code>&#123;&quot;title&quot;: &quot;Forcemain&quot;, &quot;titlecase&quot;: false&#125;</code> 与 <code>&#123;&quot;titlecase&quot;: false, &quot;title&quot;: &quot;Forcemain&quot;&#125;</code>是不同的。通常，字段顺序并不重要，无需让数据库模式依赖特定的字段顺序（MongoDB会对字段重新排序）。在某些特殊情况下，字段顺序变的非常重要，本书将就此给出提示。</p>
<p>一些编程语言对文档的默认表示根本就不包含顺序问题（如：Python中的字典）。通常，这些语言的驱动具有某些特殊的机制，可以在必要时指定文档的顺序。</p>
<h1 id="2-2-集合"><a href="#2-2-集合" class="headerlink" title="2.2 集合"></a>2.2 集合</h1><p>集合就是一组文档。如果将MongoDB中的一个文档比喻为关系型数据库中的一行，那么一个集合就相当于一张表。</p>
<h2 id="2-2-1-动态模式"><a href="#2-2-1-动态模式" class="headerlink" title="2.2.1 动态模式"></a>2.2.1 动态模式</h2><p>集合是动态模式的。这意味着一个集合里面的文档可以是各式各样的，例如，下面两个文档可以存储在同一个集合里面：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span><span class="token string-property property">"title"</span><span class="token operator">:</span> <span class="token string">"Forcemain"</span><span class="token punctuation">&#125;</span>

<span class="token punctuation">&#123;</span><span class="token string-property property">"titlecase"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>需要注意的是，上面的文档不光值的类型不同（一个是字符串，一个是布尔值），它们的键也完全不同。因为集合里面可以放置任何文档，随之而来的一个问题是：还有必要使用多个集合吗？这的确值得思考：既然没有必要区分不同类型文档的模式，为什么还要使用多个集合？这里有几个重要的原因？</p>
<ul>
<li>如果把各种各样的文档不加区分地放在同一个集合里，无论对开发者还是对管理员来说都将是噩梦。开发者要么确保每次查询只返回特定类型的文档，要么让执行查询的应用程序来处理不同类型的文档。如果查询博客文章时还要剔除含有作者数据的文档，这会带来很大困扰。</li>
<li>在一个集合里查询特定类型的文档在速度上也很不划算，分开查询多个集合要快很多。例如，假设集合里面一个名为 “type” 的字段用于指明文档是 “park”、”idc” 还是 “rack”。那么，如果从一个集合中查询这三种类型的文档，速度会很慢。但如果将这三种不同类型的文档拆分为三个不同的集合，每次只需要查询相应的集合，速度快很多。</li>
<li>把同种类型的文档放在一个集合里，数据会更加集中。从一个只包含博客文章的集合查询几篇文章，或者从同时包含文章数据和作者数据的集合里查出几篇文章，相比之下，前者需要的磁盘寻道操作更少。</li>
<li>创建索引时，需要使用文档的附加结构（特别是创建唯一索引时）。索引是按照集合来定义的。在一个集合中只放入一种类型的文档，可以更有效地对集合进行索引。</li>
</ul>
<p>上面这些重要原因促使我们创建一个模式，把相关类型的文档组织在一起，尽管MongoDB对此并没有强制要求。</p>
<h2 id="2-2-2-命名"><a href="#2-2-2-命名" class="headerlink" title="2.2.2 命名"></a>2.2.2 命名</h2><p>集合使用名称进行标识。集合名可以是满足下列条件的任意UTF-8字符串。</p>
<ul>
<li>集合名不能是空字符串（””）</li>
<li>集合名不能包含 <code>\0</code> 字符（空字符），这个字符表示集合名的结束。</li>
<li>集合名不能以 <code>system.</code> 开头，这是为系统集合保留的前缀。例如，<code>system.users</code> 这个集合保存着数据库的用户信息，而 <code>system.namespaces</code> 集合保存着所有数据库集合的信息。</li>
<li>用户创建的集合不能在集合名中包含保留字符 <code>$</code> 。因为某些系统生成的集合中包含 <code>$</code>，很多驱动程序确实支持在集合名里包含该字符。除非你要访问这种系统创建的集合，否则不应该在集合名中包含 <code>$</code>。</li>
</ul>
<p>组织集合的一种惯例是使用 “.” 分割不同的命名空间的子集合。例如，一个具有博客功能的应用可能包含两个集合，分别是 <code>blog.posts</code> 和 <code>blog.authors</code>。这是为了使组织结构更加清晰，这里的 <code>blog</code> 集合（这个集合甚至不需要存在） 跟它的子集合没有任何关系。</p>
<p>虽然子集合没有任何特别的属性，但它们却非常有用，因而很多MongoDB工具都使用了子集合。</p>
<ul>
<li>GridFS（一种用于存储大文件的协议）使用子集合来存储文件的元数据，这样就可以与文件内容块很好地隔离开来。（第 6 章会详细介绍GridFS。）</li>
<li>大多数驱动程序都提供了一些语法糖，用于访问指定集合的子集合。例如，在数据库shell中，<code>db.blog</code> 代表blog集合，而 <code>db.blog.posts</code> 代表 <code>blog.posts</code> 集合。</li>
</ul>
<p>在MongoDB中，使用子集合来组织数据非常高效，值得推荐。</p>
<h1 id="2-3-数据库"><a href="#2-3-数据库" class="headerlink" title="2.3 数据库"></a>2.3 数据库</h1><p>在MongoDB中，多个文档组成集合，而多个集合可以组成数据库。一个MongoDB实例可以承载多个数据库，每个数据库拥有0个或者多个集合。每个数据库都有独立的权限，即便是在磁盘上，不同的数据库也放置在不同的文件中。按照经验，我们将有关一个应用程序的所有数据都存储在同一个数据库中。要想在同一个MongoDB服务器上存放多个应用程序或者用户的数据，就需要使用不同的数据库。</p>
<p>数据库通过名称来标识，这点和集合类似。数据库名可以是满足以下条件的任意UTF-8字符串。</p>
<ul>
<li>不能是空字符串（””）</li>
<li>不得含有 <code>/</code>、<code>\</code>、<code>.</code>、<code>&quot;</code>、<code>*</code>、<code>&lt;</code>、<code>&gt;</code>、<code>:</code>、<code>|</code>、<code>?</code>、<code>$</code>、<code>\0</code>（空字符）。基本上只能使用ASCII中的字母和数字。</li>
<li>数据库名区分大小写，即便是在不区分大小写的文件系统中也是如此。简单起见，数据库名应全部小写。</li>
<li>数据库名最多64字节。</li>
</ul>
<p>要记住一点，数据库最终会变成文件系统里的文件，而数据库名就是相应的文件名，这是数据库名有如此多限制的原因。</p>
<p>另外，有一些数据库名是保留的，可以直接访问这些有特殊语义的数据库。这些数据库如下所示。</p>
<ul>
<li>admin<br>  从身份验证的角度来讲，这是 “root” 数据库。如果将一个用户添加到admin数据库，这个用户将自动获得所有数据库的权限。再者，一些特定的服务端命令也只能从admin数据库运行，如列出所有数据库或关闭服务器。</li>
<li>local<br>  这个数据库永远都不可以复制，且一台服务器上的所有本地集合都可以存储在这个数据库中。（第 9 章会详细介绍复制及本地数据库。）</li>
<li>config<br>  MongoDB用于分片设置时（参见第 13 章），分片信息会存储在config数据库中。</li>
</ul>
<p>把数据库名添加到集合名前，得到集合的完全限定名，即命名空间（namespace）。例如，如果要使用cms数据库中的 <code>blog.posts</code> 集合，这个集合的命名空间就是 <code>cms.blog.posts</code>。命名空间的长度不能超过121字节，且在实际使用中应小于100字节。</p>
<h1 id="2-4-启动MongoDB"><a href="#2-4-启动MongoDB" class="headerlink" title="2.4 启动MongoDB"></a>2.4 启动MongoDB</h1><p>通常，MongoDB作为网络服务器来运行，客户端可连接到该服务器并执行操作。下载MongoDB（<a target="_blank" rel="noopener" href="https://www.mongodb.com/download-center/community/releases">https://www.mongodb.com/download-center/community/releases</a>）并解压，运行 <code>mongod</code> 命令，启动数据库服务器：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ mongod<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>mongod</code> 在没有参数的情况下会使用默认数据目录<code>/data/db</code>（Windows系统为<code>&lt;安装盘&gt;:\data\db</code>）。如果数据目录不存在或不可写，服务器会启动失败。因此，在启动MongoDB前，需要先创建数据目录，并确保对该目录有写权限，这点非常重要。</p>

	  <div class="article-footer-copyright">

    本博客采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议(CC BY-NC-SA 4.0) 发布.</a>
</div>

	</div>
	<div>
  	<div>
	<div class="pagination">
    
    
    <a type="button" class="prev btn btn-default disabled">Read Prev</a>
    
    
    <a href="/2023/03/14/读书笔记/数据库/MongoDB/《MongoDB权威指南（第2版）》/第 1 部分  MongoDB 介绍/第 1 章 MongoDB介绍/" type="button" class="next btn btn-default ">Read Next</a>
    
    
</div>

	</div>
	</div>
	
	<!-- comment -->
	
		<section id="comments" class="comments">
			<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="/js/md5.min.js"></script> 
<div id="gitalk-container"></div>
<script>
var gitalkConfig = {"enable":true,"clientID":"85f6dc6eb77f33f85d4b","clientSecret":"0145804617fa807183fbea4db39c23115c67c99d","repo":"forcemain.github.io","owner":"forcemain","admin":["forcemain"],"id":"location.pathname","distractionFreeMode":true}
gitalkConfig.id=md5(location.pathname)
var gitalk = new Gitalk(gitalkConfig)
  
  gitalk.render('gitalk-container')

  </script>
		</section>
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2023-03-14 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/《MongoDB权威指南（第2版）》/">《MongoDB权威指南（第2版）》<span>5</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/《MongoDB权威指南（第2版）》/">《MongoDB权威指南（第2版）》<span>5</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#2-1-%E6%96%87%E6%A1%A3"><span class="toc-article-text">2.1 文档</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#2-2-%E9%9B%86%E5%90%88"><span class="toc-article-text">2.2 集合</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#2-2-1-%E5%8A%A8%E6%80%81%E6%A8%A1%E5%BC%8F"><span class="toc-article-text">2.2.1 动态模式</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#2-2-2-%E5%91%BD%E5%90%8D"><span class="toc-article-text">2.2.2 命名</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#2-3-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-article-text">2.3 数据库</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#2-4-%E5%90%AF%E5%8A%A8MongoDB"><span class="toc-article-text">2.4 启动MongoDB</span></a></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->


	</div>
  </div>
  <div class="container-narrow">
  <!-- <footer> <p>
  
  &copy; 2023 forcemain's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer> -->
</div> <!-- container-narrow -->
  <!--  -->


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
